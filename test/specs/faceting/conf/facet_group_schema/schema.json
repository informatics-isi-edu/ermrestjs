{
  "schema_name": "facet_group_schema",
  "tables": {
    "main": {
      "kind": "table",
      "table_name": "main",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["id"] }],
      "column_definitions": [
        {
          "name": "id",
          "type": { "typename": "text" }
        },
        {
          "name": "col1",
          "type": { "typename": "text" }
        },
        {
          "name": "col2",
          "type": { "typename": "text" }
        },
        {
          "name": "col3",
          "type": { "typename": "text" }
        },
        {
          "name": "col4",
          "type": { "typename": "text" }
        },
        {
          "name": "col5",
          "type": { "typename": "text" }
        },
        {
          "name": "col6",
          "type": { "typename": "text" }
        }
      ],
      "foreign_keys": [
        {
          "names": [["facet_group_schema", "main_fk1"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "main",
            "column_name": "id"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "outbound1",
            "column_name": "outbound1_id"
          }]
        }
      ],
      "annotations": {
        "tag:isrd.isi.edu,2019:source-definitions": {
          "columns": true,
          "fkeys": false,
          "sources": {
            "path_to_outbound1": {
              "source": [
                {"outbound": ["facet_group_schema", "main_fk1"]},
                "outbound1_id"
              ]
            },
            "path_to_assoc_related_1": {
              "source": [
                {"inbound": ["facet_group_schema", "assoc_1_fk1"]},
                {"outbound": ["facet_group_schema", "assoc_1_fk2"]},
                "assoc_related1_id"
              ]
            },
            "path_to_assoc_related1_outbound1": {
              "source": [
                {"sourcekey": "path_to_assoc_related_1"},
                {"outbound": ["facet_group_schema", "assoc_related1_outbound1_fk1"]},
                "assoc_related1_outbound1_id"
              ]
            }
          }
        },
        "tag:isrd.isi.edu,2016:visible-columns" : {
          "filter": {
            "and": [
              {"source": "id"},
              {
                "markdown_name": "Group 1",
                "and": [
                  {"sourcekey": "path_to_outbound1"}
                ]
              },
              {"source": "col1"},
              {
                "markdown_name": "**Group 2**",
                "comment": "comment for **group 2**!",
                "open": false,
                "and": [
                  {"sourcekey": "path_to_assoc_related_1", "open": true, "comment": "group closed but child open"},
                  {"sourcekey": "path_to_assoc_related1_outbound1"},
                  {"source": "col4"}
                ]
              },
              {
                "markdown_name": "Group 3",
                "comment": false,
                "and": [
                  {"source": "col5"},
                  {"source": "col6"}
                ]
              },
              {"source": "col2"},
              {"source": "col3"},
              {
                "markdown_name": "Group 1",
                "comment": "duplicate group name which should be ignored",
                "and": [
                  {"source": "col1"}
                ]
              }
            ]
          }
        }
      }
    },
    "main_no_group": {
      "kind": "table",
      "table_name": "main_no_group",
      "schema_name": "facet_group_schema",
      "keys": [
        {
          "unique_columns": [
            "id"
          ]
        }
      ],
      "column_definitions": [
        {
          "name": "id",
          "type": {
            "typename": "text"
          }
        },
        {
          "name": "col1",
          "type": {
            "typename": "text"
          }
        },
        {
          "name": "col2",
          "type": {
            "typename": "text"
          }
        }
      ],
      "annotations": {
        "tag:isrd.isi.edu,2016:visible-columns" : {
          "filter": {
            "and": [
              {"source": "id"},
              {"source": "col1"},
              {"source": "col2"}
            ]
          }
        }
      }
    },
    "main_invalid_groups": {
      "kind": "table",
      "table_name": "main_invalid_groups",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["id"] }],
      "column_definitions": [
        {
          "name": "id",
          "type": { "typename": "text" }
        },
        {
          "name": "col1",
          "type": {
            "typename": "text"
          }
        },
        {
          "name": "col2",
          "type": {
            "typename": "text"
          }
        }
      ],
      "annotations": {
        "tag:isrd.isi.edu,2016:visible-columns" : {
          "filter": {
            "and": [
              {"source": "id"},
              {
                "comment": "missing markdown_name",
                "and": [
                  {"source": "col1"},
                  {"source": "col2"}
                ]
              },
              {
                "markdown_name": "Group without children"
              },
              {
                "markdown_name": "Group without children 2",
                "comment": "empty group",
                 "and": []
              },
              {
                "markdown_name": "Group with invalid child",
                "and": [
                  {"source": "invalid_column_1"},
                  {"source": "invalid_column_2"}
                ]
              }
            ]
          }
        }
      }
    },
    "main_preselected_facets": {
      "kind": "table",
      "table_name": "main_preselected_facets",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["id"] }],
      "column_definitions": [
        {
          "name": "id",
          "type": { "typename": "text" }
        },
        {
          "name": "fk_to_outbound1",
          "type": { "typename": "text" }
        },
        {
          "name": "col1",
          "type": { "typename": "text" }
        }
      ],
      "foreign_keys": [
        {
          "names": [["facet_group_schema", "main_preselected_facets_fk1"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "main_preselected_facets",
            "column_name": "fk_to_outbound1"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "outbound1",
            "column_name": "outbound1_id"
          }]
        }

      ],
      "annotations": {
        "tag:isrd.isi.edu,2019:source-definitions": {
          "columns": true,
          "fkeys": false,
          "sources": {
            "path_to_outbound1": {
              "source": [
                {"outbound": ["facet_group_schema", "main_preselected_facets_fk1"]},
                "outbound1_id"
              ]
            }
          }
        },
        "tag:isrd.isi.edu,2016:visible-columns" : {
          "filter": {
            "and": [
              {
                "markdown_name": "Group 1",
                 "and": [
                   {
                     "sourcekey": "path_to_outbound1",
                     "choices": ["1", "3"],
                     "open": false
                   },
                   {"source": "id"}
                 ]
              }
            ]
          }
        }
      }
    },
    "outbound1": {
      "kind": "table",
      "table_name": "outbound1",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["outbound1_id"] }],
      "column_definitions": [
        {
          "name": "outbound1_id",
          "type": {
            "typename": "text"
          }
        },
        {
          "name": "name",
          "type": { "typename": "text" }
        }
      ]
    },
    "inbound1": {
      "kind": "table",
      "table_name": "inbound1",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["inbound1_id"] }],
      "column_definitions": [
        {
          "name": "inbound1_id",
          "type": {
            "typename": "text"
          }
        },
        {
          "name": "fk_to_main",
          "type": { "typename": "text" }
        }
      ],
      "foreign_keys": [
        {
          "names": [["facet_group_schema", "inbound1_fk1"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "inbound1",
            "column_name": "fk_to_main"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "main",
            "column_name": "id"
          }]
        }
      ]
    },
    "assoc_1": {
      "kind": "table",
      "table_name": "assoc_1",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["fk_to_main", "fk_to_assoc_related1"] }],
      "column_definitions": [
        {
          "name": "fk_to_main",
          "type": { "typename": "text" }
        },
        {
          "name": "fk_to_assoc_related1",
          "type": { "typename": "text" }
        }
      ],
      "foreign_keys": [
        {
          "names": [["facet_group_schema", "assoc_1_fk1"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "assoc_1",
            "column_name": "fk_to_main"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "main",
            "column_name": "id"
          }]
        },
        {
          "names": [["facet_group_schema", "assoc_1_fk2"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "assoc_1",
            "column_name": "fk_to_assoc_related1"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "assoc_related1",
            "column_name": "assoc_related1_id"
          }]
        }
      ]
    },
    "assoc_related1": {
      "kind": "table",
      "table_name": "assoc_related1",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["assoc_related1_id"] }],
      "column_definitions": [
        {
          "name": "assoc_related1_id",
          "type": { "typename": "text" }
        },
        {
          "name": "name",
          "type": { "typename": "text" }
        },
        {
          "name": "fk_to_assoc_related1_outbound1",
          "type": { "typename": "text" }
        }
      ],
      "foreign_keys": [
        {
          "names": [["facet_group_schema", "assoc_related1_outbound1_fk1"]],
          "foreign_key_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "assoc_related1",
            "column_name": "fk_to_assoc_related1_outbound1"
          }],
          "referenced_columns": [{
            "schema_name": "facet_group_schema",
            "table_name": "assoc_related1_outbound1",
            "column_name": "assoc_related1_outbound1_id"
          }]
        }
      ]
    },
    "assoc_related1_outbound1": {
      "kind": "table",
      "table_name": "assoc_related1_outbound1",
      "schema_name": "facet_group_schema",
      "keys": [{ "unique_columns": ["assoc_related1_outbound1_id"] }],
      "column_definitions": [
        {
          "name": "assoc_related1_outbound1_id",
          "type": { "typename": "text" }
        }
      ]
    }
  }
}